
<div class="container">
<h1>Semana de <%= @monday.strftime('%d %b') %> a <%= @friday.strftime('%d %b') %></h1>
</div>

<div class="container">
<% flash.each do |name, msg| %>
  <div class="alert alert-<%= name %>">
    <a class="close" data-dismiss="alert">&#215;</a>
    <%= content_tag :div, msg, :id => "flash_#{name}" if msg.is_a?(String) %>
  </div>
<% end %>
</div>

<div class="container">
<table>
    <tr>
      <th></th>
      <th class="me">Eu</th>
      <th colspan="<%= @n_collaborators - 1 %>">Equipa</th>
      <th>Total</th>
    </tr>

	<% @team_moods.each do |day, day_moods|
      daily_counter = Hash.new
      n_moods = 0
   %>
    <tr>
      <td><%= day %></td>

      <% 
        if @my_moods[day].empty?
          my_mood = 'desconhecido'
        else 
          my_mood = @my_moods[day][0].rating
        end %>
      <td class="me"><%= image_tag("legocons/" + my_mood + ".png", alt: my_mood)  %> </td>

	  <% day_moods.each do |m| 
        daily_counter[m[0]] = m[1]
        n_moods += m[1]
        n_legos = m[0] == my_mood ? m[1] - 1 : m[1];
        n_legos.times do
      %>
      	<td><%= image_tag("legocons/" + m[0] + ".png", alt: m[0])  %> </td>
      <% end %>
	  <% end %>

    <% 
       n_legos = my_mood == 'desconhecido' ? (@n_collaborators - n_moods) - 1 : (@n_collaborators - n_moods);
       n_legos.times do %>
      <td><%= image_tag("legocons/desconhecido.png", alt: "desconhecido")  %> </td>
    <% end %>

      <td>c:<%= daily_counter['contente'] || 0 %> o:<%= daily_counter['contente'] || 0 %>  <br />
      p:<%= daily_counter['preocupado'] || 0 %> t:<%= daily_counter['triste'] || 0 %></td>

    </tr>
  <% end %>

</table>
</div>

<div id="week_navigation" class="container">
<%=  
  link_to "< Semana Anterior", report_collaborators_path(@previous_week.strftime("%Y-%m-%d"))
%>
<%=  
  if @next_week 
    link_to "| Semana Seguinte >", report_collaborators_path(@next_week.strftime("%Y-%m-%d"))
  end
%>
</div>



<style type="text/css">

tr > th {
  text-align: center;
  padding: 10px 0 0 10px;
}

tr > td {
 padding: 10px 0 0 10px;
}

.me{
  padding-right: 10px;
  border-right: 2px dashed;
}

#week_navigation {
  margin-top: 30px;
}
</style>